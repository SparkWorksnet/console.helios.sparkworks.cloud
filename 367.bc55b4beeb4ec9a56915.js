"use strict";(self.webpackChunksparkworks_console=self.webpackChunksparkworks_console||[]).push([[367],{91367:function(H,I,n){n.r(I),n.d(I,{amplify_s3_album:function(){return A}});var g,v=n(68044),P=n(8239),C=n(75134),D=n(47289),M=n(88774),y=n.n(M),u=n(65513),w=n(45013),R=n(77),x=n(53799),K=n(22594),L=n(30031),U=n(84665),E=n(44314),b=n(55210),W=new Uint8Array(16);function B(){if(!g&&!(g="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(W)}var j=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function S(a){return"string"==typeof a&&j.test(a)}for(var i=[],k=0;k<256;++k)i.push((k+256).toString(16).substr(1));function Z(a,r,e){var t=(a=a||{}).random||(a.rng||B)();if(t[6]=15&t[6]|64,t[8]=63&t[8]|128,r){e=e||0;for(var s=0;s<16;++s)r[e+s]=t[s];return r}return function(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=(i[a[r+0]]+i[a[r+1]]+i[a[r+2]]+i[a[r+3]]+"-"+i[a[r+4]]+i[a[r+5]]+"-"+i[a[r+6]]+i[a[r+7]]+"-"+i[a[r+8]]+i[a[r+9]]+"-"+i[a[r+10]]+i[a[r+11]]+i[a[r+12]]+i[a[r+13]]+i[a[r+14]]+i[a[r+15]]).toLowerCase();if(!S(e))throw TypeError("Stringified UUID is invalid");return e}(t)}var f=new w.k("S3Album"),A=function(){function a(r){var e=this;(0,C.Z)(this,a),(0,u.r)(this,r),this.contentType="binary/octet-stream",this.level=K.A.Public,this.picker=!0,this.pickerText=L.T.PICKER_TEXT,this.albumItems=[],this.imgArr={},this.list=(0,P.Z)(y().mark(function t(){var s,_,o,p,c;return y().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(o=e.level,p=e.track,c=e.identityId,f.debug("Album path: "+(_=void 0===(s=e.path)?"":s)),E.Ke&&"function"==typeof E.Ke.list){l.next=4;break}throw new Error(U.d);case 4:return l.prev=4,l.next=7,E.Ke.list(_,{level:o,track:p,identityId:c});case 7:e.marshal(l.sent),l.next=14;break;case 11:l.prev=11,l.t0=l.catch(4),f.warn(l.t0);case 14:case"end":return l.stop()}},t,null,[[4,11]])})),this.marshal=function(t){t.forEach(function(o){var c=o.key.toLowerCase().split(".")[1];b.i.has(c)&&(!o.contentType||o.contentType&&"binary/octet-stream"===o.contentType)&&(o.contentType=e.getContentType(o))});var s=t.filter(function(o){return o.contentType&&o.contentType.startsWith("image/")}),_=e.filter?e.filter(s):s;_=e.sort?e.sort(_):_,e.albumItems=_,f.debug("album items",e.albumItems),e.constructImgArray(e.albumItems)},this.constructImgArray=function(t){t.map(function(s){e.imgArr["".concat(s.key)]=s.key})},this.handlePick=function(){var t=(0,P.Z)(y().mark(function s(_){var o,p,h,T,d,O;return y().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return h=e.level,T=e.track,d=(void 0===(p=e.path)?"":p)+(0,b.c)(o=_.target.files[0],e.fileToKey),m.prev=3,m.next=6,(0,b.p)(d,o,h,T,o.type,f);case 6:m.next=12;break;case 8:throw m.prev=8,m.t0=m.catch(3),f.error(m.t0),new Error(m.t0);case 12:Object.keys(e.imgArr).includes(d)?(e.albumItems=(0,v.Z)(e.albumItems),e.imgArr[d]="".concat(d,"-").concat(Z())):(O=[].concat((0,v.Z)(e.albumItems),(0,v.Z)(e.filter?e.filter([{key:d}]):[{key:d}])),e.albumItems=e.sort?e.sort(O):O);case 13:case"end":return m.stop()}},s,null,[[3,8]])}));return function(s){return t.apply(this,arguments)}}()}return(0,D.Z)(a,[{key:"getContentType",value:function(e){return(0,R.rI)(e.key,"image/*")}},{key:"componentWillLoad",value:function(){this.list()}},{key:"render",value:function(){var e=this;return(0,u.h)("div",null,(0,u.h)("div",{class:"album-container"},(0,u.h)("div",{class:"grid-row"},this.albumItems.map(function(t){return(0,u.h)("div",{class:"grid-item",key:"key-".concat(t.key)},(0,u.h)("amplify-s3-image",{key:e.imgArr[t.key],imgKey:t.key,level:e.level,path:e.path,identityId:e.identityId,track:e.track,handleOnError:e.handleOnError,handleOnLoad:e.handleOnLoad}),(0,u.h)("span",{class:"img-overlay"}))}))),this.picker&&(0,u.h)("amplify-picker",{pickerText:x.o.get(this.pickerText),inputHandler:function(s){return e.handlePick(s)},acceptValue:"image/*"}))}}]),a}();A.style=":host{--overlay-bg-color:rgba(0, 0, 0, 0.15)}.album-container{-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;margin:0 auto;padding:0 2rem}.grid-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:-1rem -1rem;padding-bottom:3rem}.grid-item{position:relative;-ms-flex:1 0 22rem;flex:1 0 22rem;-ms-flex-positive:1;flex-grow:1;margin:1rem;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}amplify-s3-image{--width:22rem;--height:20rem;border-radius:5px;-o-object-fit:cover;object-fit:cover}.img-overlay{display:none;width:100%;height:21rem;position:absolute;top:0;left:0;background-color:var(--overlay-bg-color)}.grid-item:hover .img-overlay{display:block}"}}]);